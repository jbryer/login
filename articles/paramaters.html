<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>User Defined Shiny Parameters • login</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="User Defined Shiny Parameters">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">login</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/login.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/paramaters.html">User Defined Shiny Parameters</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jbryer/login/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>User Defined Shiny Parameters</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jbryer/login/blob/main/vignettes/paramaters.Rmd" class="external-link"><code>vignettes/paramaters.Rmd</code></a></small>
      <div class="d-none name"><code>paramaters.Rmd</code></div>
    </div>

    
    
<p><strong>tl;dr</strong></p>
<p>Once the <code>login</code> package is installed, you can run two
demos using the following commands:</p>
<ul>
<li><p><code>shiny::runApp(paste0(find.package('login'), '/user_params/'))</code><br><a href="https://github.com/jbryer/login/blob/main/inst/user_params/app.R" class="external-link">https://github.com/jbryer/login/blob/main/inst/user_params/app.R</a></p></li>
<li><p><code>shiny::runApp(paste0(find.package('login'), '/data_viewer/'))</code><br><a href="https://github.com/jbryer/login/blob/main/inst/data_viewer/app.R" class="external-link">https://github.com/jbryer/login/blob/main/inst/data_viewer/app.R</a></p></li>
</ul>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Shiny is an incredible tool for interactive data analysis. For the
vast majority of Shiny applications I have developed I make a choice
regarding the default state of the application, but provide plenty of
options for the user to change and/or customize the analysis. However,
there are situations where the application would be better if the user
was required to input certain parameters. Conceptually I often think of
Shiny applications as an interactive version of a function, a function
with many parameters, some of which the user needs to define the default
parameters. This vignette describes a Shiny module where a given set of
parameters must be set before the user engages with the main Shiny
application, and those settings can be optionally saved as cookies to be
used across sessions. Even though this is the main motivation for this
Shiny module, it can also be used as a framework for saving user
preferences where saving state on the Shiny server is not possible
(e.g. when deployed to <a href="https://www.shinyapps.io" class="external-link">www.shinyapps.io</a>).</p>
<p>The user parameter module is part of the <code>login</code> R
package. The goal is to present the user with a set of parameters in a
modal dialog as the Shiny application loads. The primary interface is
through the <code><a href="../reference/userParamServer.html">userParamServer()</a></code> function that can be included
in the server code. The following is a basic example.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">userParamServer</span>(</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>    <span class="at">id =</span> <span class="st">'example'</span>,</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>    <span class="at">params =</span> <span class="fu">c</span>(<span class="st">'name'</span>, <span class="st">'email'</span>),</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>    <span class="at">param_labels =</span> <span class="fu">c</span>(<span class="st">'Your Name:'</span>, <span class="st">'Email Address:'</span>),</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>    <span class="at">param_types =</span> <span class="fu">c</span>(<span class="st">'character'</span>, <span class="st">'character'</span>),</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>    <span class="at">intro_message =</span> <span class="st">'This is an example application that asks the user for two parameters.'</span>),</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>    validator <span class="ot">=</span> my_validator</span></code></pre></div>
<p>Like all <a href="https://mastering-shiny.org/scaling-modules.html" class="external-link">Shiny
modules</a>, the <code>id</code> parameter is a unique identifier
connected the server logic to the UI components. The <code>params</code>
parameter is a character vector for the names of the parameters users
need to input. These are the only two required parameters. By default
all the parameters will assume to be characters using the
<code><a href="https://rdrr.io/pkg/shiny/man/textInput.html" class="external-link">shiny::textInput()</a></code> function. However, the module supports
multiple input types including:</p>
<ul>
<li>
<code>character</code> - String values</li>
<li>
<code>password</code> - String values but will use the
<code><a href="https://rdrr.io/pkg/shiny/man/passwordInput.html" class="external-link">shiny::passwordInput</a></code> instead.</li>
<li>
<code>date</code> - Date values</li>
<li>
<code>numeric</code> - Numeric values</li>
<li>
<code>logical</code> - Logical values, will be displayed as a
checkbox.</li>
<li>
<code>file</code> - File uploads (note the value will be the path to
where the file is uploaded)</li>
<li>
<code>select</code> - Drop down selection. This type requires
additional information vis-à-vis the <code>input_params</code> parameter
discussed latter.</li>
</ul>
<p>The above will present the user with a modal dialog immediately when
the Shiny application starts up as depicted below.</p>
<p><img src="screenshot_params1.png" width="90%" style="display: block; margin: auto;"></p>
<p>The values can then be retrieved from the <code>params</code> object,
which is depicted in the figure below.</p>
<p><img src="screenshot_params2.png" width="90%" style="display: block; margin: auto;"></p>
<p>The <code><a href="../reference/userParamServer.html">userParamServer()</a></code> function returns a
<code><a href="https://rdrr.io/pkg/shiny/man/reactiveValues.html" class="external-link">shiny::reactiveValues()</a></code> object. As a result, any code that
uses these values should automatically be updated if the values
change.</p>
<p>There are two UI components, specifically the
<code><a href="../reference/userParamServerButtons.html">showParamButton()</a></code> and <code><a href="../reference/userParamServerButtons.html">clearParamButton()</a></code>
buttons. The former will display the modal dialog allowing the user to
change the values. The latter will clear all the values set (including
cookies if enabled).</p>
</div>
<div class="section level2">
<h2 id="cookies">Cookies<a class="anchor" aria-label="anchor" href="#cookies"></a>
</h2>
<p>It is possible to save the user’s parameter values across session by
saving them to cookies (as long as <code>allow_cookies = TRUE</code>).
If the <code>allow_cookies</code> parameter is <code>TRUE</code>, the
user can still opt to not save the values as cookies. It is recommend to
set the <code>cookie_password</code> value so that the cookie values are
encrypted. This feature uses the <a href="https://cookies.shinyworks.org" class="external-link">cookies</a> R package and requires
that <code><a href="https://rdrr.io/pkg/cookies/man/cookie_dependency.html" class="external-link">cookies::cookie_dependency()</a></code> is place somewhere in the
Shiny UI.</p>
</div>
<div class="section level2">
<h2 id="full-shiny-demo">Full Shiny Demo<a class="anchor" aria-label="anchor" href="#full-shiny-demo"></a>
</h2>
<p>The figures above are from the Shiny application provided below.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://shiny.posit.co/" class="external-link">shiny</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jbryer/login" class="external-link">login</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r4ds/cookies" class="external-link">cookies</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">#' Simple email validator.</span></span>
<span><span class="co">#' @param x string to test.</span></span>
<span><span class="co">#' @return TRUE if the string is a valid email address.</span></span>
<span><span class="va">is_valid_email</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"\\&lt;[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,}\\&gt;"</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, ignore.case<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' Custom validator function that also checks if the `email` field is a valid email address.</span></span>
<span><span class="va">my_validator</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">values</span>, <span class="va">types</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">spv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simple_parameter_validator.html">simple_parameter_validator</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">is.logical</a></span><span class="op">(</span><span class="va">spv</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">spv</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="kw">if</span><span class="op">(</span><span class="fu">is_valid_email</span><span class="op">(</span><span class="va">values</span><span class="op">[[</span><span class="st">'email'</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>            <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">values</span><span class="op">[[</span><span class="st">'email'</span><span class="op">]</span><span class="op">]</span>, <span class="st">' is not a valid email address.'</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html" class="external-link">fluidPage</a></span><span class="op">(</span></span>
<span>    <span class="fu">cookies</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/cookies/man/cookie_dependency.html" class="external-link">cookie_dependency</a></span><span class="op">(</span><span class="op">)</span>,  <span class="co"># Necessary to save/get cookies</span></span>
<span>    <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/titlePanel.html" class="external-link">titlePanel</a></span><span class="op">(</span><span class="st">'Parameter Example'</span><span class="op">)</span>,</span>
<span>    <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/textOutput.html" class="external-link">verbatimTextOutput</a></span><span class="op">(</span><span class="st">'param_values'</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/userParamServerButtons.html">showParamButton</a></span><span class="op">(</span><span class="st">'example'</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/userParamServerButtons.html">clearParamButton</a></span><span class="op">(</span><span class="st">'example'</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/userParamServer.html">userParamServer</a></span><span class="op">(</span></span>
<span>        id <span class="op">=</span> <span class="st">'example'</span>,</span>
<span>        validator <span class="op">=</span> <span class="va">my_validator</span>,</span>
<span>        params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'name'</span>, <span class="st">'email'</span><span class="op">)</span>,</span>
<span>        param_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Your Name:'</span>, <span class="st">'Email Address:'</span><span class="op">)</span>,</span>
<span>        param_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'character'</span>, <span class="st">'character'</span><span class="op">)</span>,</span>
<span>        intro_message <span class="op">=</span> <span class="st">'This is an example application that asks the user for two parameters.'</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">output</span><span class="op">$</span><span class="va">param_values</span> <span class="op">&lt;-</span> <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPrint.html" class="external-link">renderText</a></span><span class="op">(</span><span class="op">{</span></span>
<span>        <span class="va">txt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span></span>
<span>        <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">txt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">txt</span>, <span class="va">i</span>, <span class="st">' = '</span>, <span class="va">params</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="st">'\n'</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">txt</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html" class="external-link">shinyApp</a></span><span class="op">(</span>ui <span class="op">=</span> <span class="va">ui</span>, server <span class="op">=</span> <span class="va">server</span>, options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>port <span class="op">=</span> <span class="fl">2112</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="validation">Validation<a class="anchor" aria-label="anchor" href="#validation"></a>
</h2>
<p>The <code>validator</code> parameter speicies a validation function
to ensure the parameters entered by the user are valid. The default
value of <code><a href="../reference/simple_parameter_validator.html">simple_parameter_validator()</a></code> simply ensures that
values have been entered. The Shiny application above extends this by
also checking to see if the email address appears to be valid.</p>
<p>Validations functions must adhere to the following:</p>
<ol style="list-style-type: decimal">
<li><p>It must take two parameters: <code>values</code> which is a
character vector the user has entered and <code>types</code> which is a
character vector of the types described above.</p></li>
<li><p>Return <code>TRUE</code> if the validaiton passes OR a character
string describing why the validation failed. This message will be
displayed to the user.</p></li>
</ol>
<p>If the validation function returns anything other than
<code>TRUE</code> the modal dialog will be displayed.</p>
<div class="section level3">
<h3 id="customizing-the-shiny-inputs">Customizing the Shiny inputs<a class="anchor" aria-label="anchor" href="#customizing-the-shiny-inputs"></a>
</h3>
<p>The <code>input_params</code> parameter allows for further
customization of the various Shiny inputs. In particular, you can put
any other <code>shiny::xxxInput</code> parameters into a list. For
<code>select</code> input types the <code>choices</code> parameter is
required. The following template provides the basic structure:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">input_params</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>PARAM1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Option A'</span>, <span class="st">'Option B'</span><span class="op">)</span><span class="op">)</span>, <span class="co"># When select is the type</span></span>
<span>                    PARAM2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">10</span>, stap <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="co"># When numeric or integer is the type</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="file-input-example">File Input Example<a class="anchor" aria-label="anchor" href="#file-input-example"></a>
</h2>
<p>The following Shiny application demonstrates how to use the file
upload and drop down selection features.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://shiny.posit.co/" class="external-link">shiny</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jbryer/login" class="external-link">login</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r4ds/cookies" class="external-link">cookies</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">#' Custom validator function that also checks if the `file` field is a valid CSV file.</span></span>
<span><span class="va">my_validator</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">values</span>, <span class="va">types</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">spv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simple_parameter_validator.html">simple_parameter_validator</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">is.logical</a></span><span class="op">(</span><span class="va">spv</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">spv</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">values</span><span class="op">$</span><span class="va">file</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="st">'File does not exists. Try uploading again.'</span><span class="op">)</span></span>
<span>        <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu">tools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/tools/fileutils.html" class="external-link">file_ext</a></span><span class="op">(</span><span class="va">values</span><span class="op">$</span><span class="va">file</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'csv'</span>, <span class="st">'xslx'</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="st">'Only CSV and XLSX files supported.'</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html" class="external-link">fluidPage</a></span><span class="op">(</span></span>
<span>    <span class="fu">cookies</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/cookies/man/cookie_dependency.html" class="external-link">cookie_dependency</a></span><span class="op">(</span><span class="op">)</span>,  <span class="co"># Necessary to save/get cookies</span></span>
<span>    <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/titlePanel.html" class="external-link">titlePanel</a></span><span class="op">(</span><span class="st">'Data Viewer'</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/userParamServerButtons.html">showParamButton</a></span><span class="op">(</span><span class="st">'csvviewer'</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/userParamServerButtons.html">clearParamButton</a></span><span class="op">(</span><span class="st">'csvviewer'</span><span class="op">)</span>,</span>
<span>    <span class="fu">DT</span><span class="fu">::</span><span class="fu">DTOutput</span><span class="op">(</span><span class="st">'data_table'</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/userParamServer.html">userParamServer</a></span><span class="op">(</span></span>
<span>        id <span class="op">=</span> <span class="st">'csvviewer'</span>,</span>
<span>        validator <span class="op">=</span> <span class="va">my_validator</span>,</span>
<span>        params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'filetype'</span>, <span class="st">'file'</span><span class="op">)</span>,</span>
<span>        param_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'File type'</span>, <span class="st">'URL to a CSV file:'</span><span class="op">)</span>,</span>
<span>        input_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"filetype"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"choices"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"CSV"</span> <span class="op">=</span> <span class="st">"csv"</span>, <span class="st">"Excel"</span> <span class="op">=</span> <span class="st">"xlsx"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        param_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'select'</span>, <span class="st">'file'</span><span class="op">)</span>,</span>
<span>        intro_message <span class="op">=</span> <span class="st">'This application will view a spreadsheet as a data table.'</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">output</span><span class="op">$</span><span class="va">data_table</span> <span class="op">&lt;-</span> <span class="fu">DT</span><span class="fu">::</span><span class="fu">renderDT</span><span class="op">(</span><span class="op">{</span></span>
<span>        <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span>        <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">params</span><span class="op">$</span><span class="va">file</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="kw">if</span><span class="op">(</span><span class="va">params</span><span class="op">$</span><span class="va">filetype</span> <span class="op">==</span> <span class="st">'csv'</span><span class="op">)</span> <span class="op">{</span></span>
<span>                <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">params</span><span class="op">$</span><span class="va">file</span><span class="op">)</span></span>
<span>            <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">params</span><span class="op">$</span><span class="va">filetype</span> <span class="op">==</span> <span class="st">'xlsx'</span><span class="op">)</span> <span class="op">{</span></span>
<span>                <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu">read_excel</span><span class="op">(</span><span class="va">params</span><span class="op">$</span><span class="va">file</span><span class="op">)</span></span>
<span>            <span class="op">}</span></span>
<span>        <span class="op">}</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html" class="external-link">shinyApp</a></span><span class="op">(</span>ui <span class="op">=</span> <span class="va">ui</span>, server <span class="op">=</span> <span class="va">server</span>, options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>port <span class="op">=</span> <span class="fl">2112</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jason Bryer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
